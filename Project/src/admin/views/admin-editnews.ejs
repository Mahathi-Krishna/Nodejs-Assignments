<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Home</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
</head>
<body onload= <% if (message) { %> myFunction() <% } %>>

<%- include('admin-header') %>

<div class="container" style="min-height: 550px;">
<br>
<div class="container">
  <br>
  <div class="row">
    <div class="col-md-12">
      <table class="table table-inverse">
        <thead>
          <tr>
            <th>S.No</th>
            <th>Title</th>
            <th>Description</th>
            <th>Image Url</th>
            <th>Posted On</th>
          </tr>
        </thead>

        <tbody style="min-height: 30px; overflow: hidden;">
          <% for(var i=0; i < result.length; i++) { %>
          <tr>
          <form class="form-inline form-selection" id="selectForm" name="selectForm">
            <td><%= i+1 %></td>
            <td><textarea id="title" name ="title" class="form-control" rows="5" cols="30"><%= result[i].title %></textarea></td>
            <td><textarea id="detail" name ="detail" class="form-control" rows="5" cols="50"><%= result[i].detail %></textarea></td>
            <td><textarea id="image" name ="image" class="form-control" rows="5" cols="20"><%= result[i].image %></textarea></td>
            <td><textarea id="created" name ="created" class="form-control" rows="5"><%= result[i].created %></textarea></td>
            <td>
              <button type="submit" id="btnedit" onClick=editFunction() class="btn btn-primary">Edit</button>
              <!-- <input type="submit" name="editbutton" id="<%= result[i]._id %>" onclick="editFunction()" value="Edit" class="btn btn-primary"> -->
            </td>
            <td>
              <button type="submit" id="btndelete" class="btn btn-primary" style="background-color: red;">Delete</button>
              <!-- <input type="submit" name="deletebutton" id="<%= result[i]._id %>" onclick="deleteFunction()" value="Delete" class="btn btn-primary" style="background-color: red;"> -->
            </td>
          </form>
          </tr>
          <% } %>
        </tbody>
      </table>
    </div>
  </div>
</div>
</div>

<%- include('footer') %>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="/js/postrequest.js"></script>

    <script>
      function myFunction() {
        alert("<%= message %>");
      };
    </script>

<script>
  function editFunction() {
    const selectForm = document.getElementById('btnedit');
      selectForm.addEventListener('click', (e)=>{
          // e.preventDefault();

          var title = document.getElementById('title').value;
          var detail = document.getElementById('detail').value;
          var image = document.getElementById('image').value;
          var created = document.getElementById('created').value;

          var payload = {
            title: title,
            detail: detail,
            image: image,
            created:created
          };

          // DO POST
          $.ajax({
              type : "POST",
              url : "/admin/editnews",
              contentType : "application/json",
              data : JSON.stringify(payload),
              dataType : "json",  
          }).done(function(data){
                console.log(data.title);
                alert(data.title);
              return;
          });
      });
  };
</script>

    <!-- <script>
      function editFunction() {
        let vare = document.getElementsByName("id").values;
        alert("Clicked this id:"+vare);
        };
    </script>

    <script>
      function deleteFunction() {
        let vare = document.getElementsByName("id").values;
        alert("Clicked this id:"+vare);
      };
    </script> -->

</body>
</html>